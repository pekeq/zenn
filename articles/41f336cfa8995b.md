---
title: "Google Nest Wifiã¨ãƒ•ãƒ¬ãƒƒãƒ„å…‰ã§IPv6ã—ãŸã„"
emoji: "ğŸŒ"
type: "tech"
topics: ["googlehome","network","yamaha","ipv6","googlewifi"]
published: true
---
# ã¯ã˜ã‚ã«

ä¸€èˆ¬çš„ãªWifi APå°‚ç”¨æ©ŸãŒãƒ–ãƒªãƒƒã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã™ã‚‹ã®ã¨ç•°ãªã‚Šã€Google Nest Wifiï¼ˆæ—§è£½å“ã®Google Wifiå«ã‚€ï¼‰ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãƒ«ãƒ¼ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã—ã¾ã™ã€‚
ã»ã¼ç´ é€šã—ã®ãƒ–ãƒªãƒƒã‚¸ãƒ¢ãƒ¼ãƒ‰ã¨é•ã„ã€ãƒ«ãƒ¼ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã¯åˆ©ç”¨ã™ã‚‹IPv6ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å‰²ã‚Šå½“ã¦ãŒå¿…è¦ã«ãªã‚‹ãŸã‚ã€ãƒ•ãƒ¬ãƒƒãƒ„å…‰æ¥ç¶šã—ã¦ã„ã‚‹ãƒ«ãƒ¼ã‚¿ãƒ¼é…ä¸‹ã«Google Nest Wifiã‚’æ¥ç¶šã—ãŸå ´åˆã€IPv6ã‚’ä½¿ã†ã«ã¯ã¡ã‚‡ã£ã¨é¢å€’ãªè¨­å®šãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚

ãƒ–ãƒªãƒƒã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã•ã›ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ãŒã€ãã®å ´åˆã¯ãƒ¡ãƒƒã‚·ãƒ¥ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚„ãƒ•ã‚¡ãƒŸãƒªãƒ¼Wi-Fiãªã©ã€Google Nest Wifiãªã‚‰ã§ã¯ã®æ©Ÿèƒ½ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚
ã›ã£ã‹ããªã‚‰ã°ãƒ•ãƒ«æ©Ÿèƒ½ã®Google Nest Wifiç’°å¢ƒã§IPv6ã‚’ä½¿ã„ãŸã„ã‚‚ã®ã§ã™ã€‚ã“ã®Articleã§ã¯ãã®æ–¹æ³•ã®ä¸€ä¾‹ã‚’è§£èª¬ã—ã¾ã™ã€‚

ã¡ãªã¿ã«ã€ã¡ã‚‡ã£ã¨é¢å€’ãªã®ã¯IPv6ã‚’ä½¿ã†ã¨ãã ã‘ã§ã€Wifiã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ãªã©ï¼‰ã‹ã‚‰IPv4ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã™ã‚‹ã ã‘ãªã‚‰ã°ã€ã»ã¼Plug and Playã§ä½¿ãˆã¾ã™ã€‚

# ã–ã£ãã‚Šè¨€ã†ã¨

Google Nest Wifiãƒ«ãƒ¼ã‚¿ãƒ¼ãŠã‚ˆã³Google Wifiãƒ«ãƒ¼ã‚¿ãƒ¼ã§IPv6ã‚’ä½¿ã†ã«ã¯ã€ä»¥ä¸‹ã®è¦ä»¶ã‚’æº€ãŸã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
- DHCPv6ã§ã€Google Nest Wifiãƒ«ãƒ¼ã‚¿ãƒ¼WANå´I/Fã®IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰²ã‚Šå½“ã¦ã‚‹
- DHCPv6-PDã§ã€Google Nest Wifiãƒ«ãƒ¼ã‚¿ãƒ¼ãŒLANå´ã§åºƒå‘Šã™ã‚‹IPv6ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’é…å¸ƒã™ã‚‹
- ãƒ•ãƒ¬ãƒƒãƒ„å…‰å´ãƒ«ãƒ¼ã‚¿ãƒ¼ã®IPv6è¨­å®šã§ã€Google Nest Wifiãƒ«ãƒ¼ã‚¿ãƒ¼ã«é…å¸ƒã—ãŸIPv6ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’ã™ã‚‹

ã“ã‚Œã‚‰ã®è¦ä»¶ã‚’æº€ãŸã™ãŸã‚ã«ã¯ä»¥ä¸‹ã®å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
- ã²ã‹ã‚Šé›»è©±ã‚’å¥‘ç´„ã™ã‚‹ï¼ˆ/56ã‚’å—ã‘å–ã‚‹ãŸã‚ï¼‰
- NGNç¶²ã‹ã‚‰å—ã‘å–ã£ãŸ/56ã‹ã‚‰ä¸€éƒ¨ã‚’DHCPv6-PDã§é…ã‚‹ç’°å¢ƒã‚’ä½œã‚‹

ä»Šå›ä½¿ã†ãƒ«ãƒ¼ã‚¿ãƒ¼(YAMAHA NVR500)ã«ã¯DHCPv6-PDã®ã‚µãƒ¼ãƒãƒ¼æ©Ÿèƒ½ãŒãªã„ã®ã§ã€[Kea DHCP server](https://kea.isc.org/)ã¨ã„ã†DHCPv6-PDã«å¯¾å¿œã—ãŸDHCPã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ã£ã¦ã€Google Nest Wifiãƒ«ãƒ¼ã‚¿ãƒ¼ã«IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’é…å¸ƒã—IPv6 readyãªç’°å¢ƒã‚’æ•´ãˆã¾ã™ã€‚

# è©³ã—ãè¨€ã†ã¨

Google Nest WifiãŒIPv6æ¥ç¶šã™ã‚‹è¦ä»¶ã¯ [IPv6](https://support.google.com/googlenest/answer/6361450?hl=en) ã®ãƒ˜ãƒ«ãƒ—ãƒšãƒ¼ã‚¸ã«èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ã€‚æ—¥æœ¬èªãƒšãƒ¼ã‚¸ã¯"prefix"ã‚’ã€Œæ¥é ­è¾ã€ã¨ç¿»è¨³ã—ã¦ã„ãŸã‚Šã—ã¦èª­ã¿ã¥ã‚‰ã„ã®ã§ã€è‹±èªãƒšãƒ¼ã‚¸ã‹ã‚‰å¼•ç”¨ã—ã¾ã™ã€‚

> When IPv6 is enabled on Google Nest Wifi or Google Wifi, it uses the DHCPv6 protocol on its WAN port to request an address from your ISP.

Google Nest Wifiã¾ãŸã¯Google Wifiã§IPv6ã‚’æœ‰åŠ¹ã«ã—ãŸå ´åˆã€WANãƒãƒ¼ãƒˆå´ã§DHCPv6ã‚’ä½¿ã£ã¦ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã—ã¾ã™ã€‚
ï¼ˆã“ã®ã‚ã¨ã®æ–‡ç« ã§ã€DHCPv6ãŒãªã„å ´åˆã¯IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹è‡ªå‹•è¨­å®š(SLAAC)ã‚’ä½¿ã£ã¦IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å–å¾—ã‚’è©¦è¡Œã™ã‚‹ã¨ã„ã†è¨˜è¼‰ãŒã‚ã‚Šã¾ã™ãŒã€è©¦ã—ãŸã“ã¨ãŒãªã„ã®ã§å‰²æ„›ã—ã¾ã™ï¼‰

> The router also requests an IPv6 prefix from the ISP, which is used to send the IPv6 router advertisements to the clients on the LAN, to allow them to derive their own addresses.

ãƒ«ãƒ¼ã‚¿ãƒ¼ãŒIPv6ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã—ãŸå¾Œã€ISPã«å¯¾ã—ã¦ï¼ˆWANå´ã§ï¼‰LANå´ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«åºƒå‘Šã™ã‚‹IPv6 prefixã‚’è¦æ±‚ã—ã¾ã™ã€‚

> If the ISP provides a usable prefix, Google Nest Wifi and Google Wifi will start sending IPv6 routing advertisements to clients on the LAN to allow them to pick and validate their own IPv6 addresses using the SLAAC (or â€œslackâ€) procedure.

ISPãŒï¼ˆWANå´ã‹ã‚‰ï¼‰æœ‰åŠ¹ãªprefixã‚’å¾—ã‚‰ã‚ŒãŸå ´åˆã€Google Nest Wifiã¾ãŸã¯Google Wifiã¯LANå´ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«IPv6ãƒ«ãƒ¼ã‚¿ãƒ¼åºƒå‘Šã‚’é€ä¿¡ã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒSLAACï¼ˆã‚¢ãƒ‰ãƒ¬ã‚¹è‡ªå‹•è¨­å®šï¼‰ã§IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¾—ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ã¤ã¾ã‚Šã¯ã€WANå´ã‹ã‚‰DHCPv6ã§Google Nest Wifiã®WANå´I/Fã®IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰²ã‚Šå½“ã¦ã€DHCPv6-PDã§Google Nest Wifiã®LANå´ã«åºƒå‘Šã™ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’é…å¸ƒã™ã‚Œã°è‰¯ã„ã‚ã‘ã§ã™ã€‚

# æ¤œè¨¼ç’°å¢ƒ

- ãƒ•ãƒ¬ãƒƒãƒ„å…‰ãƒã‚¯ã‚¹ãƒˆï¼ˆã²ã‹ã‚Šé›»è©±å¥‘ç´„ã‚ã‚Šï¼‰
- ãƒ¤ãƒãƒ NVR500
- Raspberry Pi 3 Model B+
- Kea DHCP server (https://kea.isc.org/)
- Google Nest Wifiãƒ«ãƒ¼ã‚¿ãƒ¼ (Model:H2D)
  - Google Wifiãƒ«ãƒ¼ã‚¿ãƒ¼ (Model:AC-1304)ã§ã‚‚åŒæ§˜ã®æ§‹æˆã§IPv6ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªæ¸ˆã¿ã§ã™

# æ§‹æˆ

```mermaid
graph TB
   A["ãƒ•ãƒ¬ãƒƒãƒ„å…‰ï¼ˆNGNç¶²ï¼‰"] --- F[ONU]
   F ---|"xxxx:xxxx:2900:200::/56"| B["ãƒ«ãƒ¼ã‚¿ãƒ¼(ãƒ¤ãƒãƒ NVR500)"]
   B ---|"xxxx:xxxx:2900:201::/64"| C[Google Nest Wifiãƒ«ãƒ¼ã‚¿ãƒ¼]
   B --- D[Raspberry Pi]
   C ---|"xxxx:xxxx:2900:210::/64"| E["Wifiã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆPCã€ã‚¹ãƒãƒ›ç­‰ï¼‰"]
```

# æ‰‹é †

1. ãƒ•ãƒ¬ãƒƒãƒ„å…‰å´ã®ãƒ«ãƒ¼ã‚¿ãƒ¼ã§ /54 ã‚’å—ã‘ã¦ã€LANå´ã«ã‚µãƒ–ãƒãƒƒãƒˆå‡ºã™
2. Google Nest Wifiã®MACã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’èª¿ã¹ã‚‹ï¼ˆæœ¬ä½“ã®è£ã«æ›¸ã„ã¦ã‚ã‚‹ï¼‰
3. Kea DHCPã‚µãƒ¼ãƒãƒ¼ã®è¨­å®šã‚’ã™ã‚‹
4. ãƒ•ãƒ¬ãƒƒãƒ„å…‰å´ã®ãƒ«ãƒ¼ã‚¿ãƒ¼ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®šã™ã‚‹
5. Google Nest Wifiã®IPv6ã‚’æœ‰åŠ¹ã«ã™ã‚‹

# ãƒ•ãƒ¬ãƒƒãƒ„å…‰å´ã®ãƒ«ãƒ¼ã‚¿ãƒ¼(NVR500)è¨­å®š

LAN1ã«LANã€LAN2ã«WANï¼ˆãƒ•ãƒ¬ãƒƒãƒ„å…‰ã®ONUï¼‰ãŒæ¥ç¶šã•ã‚Œã¦ã„ã‚‹ã¨ã—ã¾ã™ã€‚
lan1ã¯DHCPv6ã§ã‚¢ãƒ‰ãƒ¬ã‚¹é…å¸ƒã™ã‚‹ã®ã§ã€ãƒ«ãƒ¼ã‚¿ãƒ¼åºƒå‘Šã« `m_flag=on o_flag=on` ã‚’ã¤ã‘ã‚‹ã“ã¨ä»¥å¤–ã¯ã€ä¸€èˆ¬çš„ãªãƒ¤ãƒãƒãƒ«ãƒ¼ã‚¿ãƒ¼RTX/NVRã‚·ãƒªãƒ¼ã‚ºã®è¨­å®šã¨åŒã˜ã§ã™ã€‚

å‚è€ƒ: [ãƒ•ãƒ¬ãƒƒãƒ„å…‰ãƒã‚¯ã‚¹ãƒˆ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ(IPv6 IPoE)æ¥ç¶šï¼‹ã²ã‹ã‚Šé›»è©±](https://network.yamaha.com/setting/router_firewall/flets/flets_other_service/ipv6_ipoe-nvr500)


```
ipv6 prefix 1 dhcp-prefix@lan2::1:0:0:0:1/64
ipv6 lan1 address dhcp-prefix@lan2::1:0:0:0:1/64
ipv6 lan1 rtadv send 1 m_flag=on o_flag=on
ipv6 lan2 address dhcp
ipv6 lan2 dhcp service client
ipv6 route default gateway dhcp lan2
```

# Kea DHCPã‚µãƒ¼ãƒãƒ¼ã®è¨­å®šã‚’ã™ã‚‹

Debianç³»Linuxã§ã¯ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚Œã°OKã§ã™ã€‚

```
$ sudo apt update
$ sudo apt install kea-dhcp4-server kea-dhcp6-server
```

## kea-dhcp6-server

Keaã®è¨­å®šã¯JSONãƒ•ã‚¡ã‚¤ãƒ«ã§è¨˜è¿°ã—ã¾ã™ã€‚
ã‚­ãƒ¢ã«ãªã‚‹éƒ¨åˆ†ã¯ `Dhcp6.subnet6[].reservations[].prefixes[]` ã®éƒ¨åˆ†ã§ã€ã“ã“ã«Google Wifiãƒ«ãƒ¼ã‚¿ãƒ¼ã«é…å¸ƒã™ã‚‹IPv6ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

ä»¥ä¸‹ã®ä¾‹ã§ã¯ `xxxx:xxxx:2900:210::/64` ã‚’é…å¸ƒã—ã¦ã„ã¾ã™ãŒã€ã‚²ã‚¹ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã‚‚IPv6ã‚’ä½¿ã„ãŸã„å ´åˆã¯ã€ã“ã“ã‚’/64ã‚ˆã‚ŠçŸ­ã„ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆ/63ã¨ã‹ï¼‰ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
å‚è€ƒ: [IPv6ï¼ˆGoogle Nest Wifiãƒ˜ãƒ«ãƒ—ï¼‰](https://support.google.com/googlenest/answer/6361450?hl=en)

:::details è©²å½“ç®‡æ‰€
> IPv6 on guest network
> Google Nest Wifi and Google Wifi support IPv6 on all LAN connections, including wired LAN and private WLAN. Google Nest Wifi and Google Wifi also support guest networking for IPv6, however your ISP must provide a network prefix length thatâ€™s less than 64 bits to allow for proper subnet addressing. If the ISPâ€™s prefix is 64 bits, IPv6 wonâ€™t be available on the guest network.

Google Nest WifiãŠã‚ˆã³Google Wifiã¯æœ‰ç·šãƒãƒ¼ãƒˆã¨ç„¡ç·šå«ã‚ãŸå…¨ã¦ã®LANæ¥ç¶šã§IPv6ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã€‚ã‚²ã‚¹ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã‚‚IPv6ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ãŒã€ãã®å ´åˆã¯ISPã¯64ãƒ“ãƒƒãƒˆã‚ˆã‚Šã‚‚çŸ­ã„prefixã§ã‚µãƒ–ãƒãƒƒãƒˆã‚’å‰²ã‚Šå½“ã¦ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚prefixãŒ64ãƒ“ãƒƒãƒˆã®å ´åˆã¯ã‚²ã‚¹ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§IPv6ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œãªã„ã€‚
:::

### ã‚³ãƒãƒ³ãƒ‰ä¾‹

```
$ sudo vi /etc/kea/kea-dhcp6.conf
$ sudo systemctl start kea-dhcp6-server.service
```

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¾‹

```json:/etc/kea/kea-dhcp6.conf
{
  "Dhcp6": {
    "interfaces-config": {
      "interfaces": ["eth0"]
    },

    "lease-database": {
      "type": "memfile",
      "lfc-interval": 3600,
      "name": "/var/lib/kea/kea-leases6.csv"
    },

    "renew-timer": 7200,
    "rebind-timer": 10800,
    "preferred-lifetime": 12600,
    "valid-lifetime": 14400,

    "option-data": [
      // ä¾‹: ãƒ•ãƒ¬ãƒƒãƒ„ã®NTPã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨
      { "name": "sntp-servers", "data": "2404:1a8:1102::a, 2404:1a8:1102::b" }
    ],

    "subnet6": [
      {
        // ãƒ•ãƒ¬ãƒƒãƒ„ã‹ã‚‰é…å¸ƒã•ã‚Œã¦ããŸIPv6ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
        "subnet": "xxxx:xxxx:2900:200::/56",
        "interface": "eth0",
        "pools": [
          // DHCPv6ã§é…å¸ƒã™ã‚‹IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹
          { "pool": "xxxx:xxxx:2900:201::1000-xxxx:xxxx:2900:201::f000" }
        ],

        "reservations": [
          {
            // Google Nest Wifiãƒ«ãƒ¼ã‚¿ãƒ¼ã®MACã‚¢ãƒ‰ãƒ¬ã‚¹
            "hw-address": "24:05:88:aa:bb:cc",
            // DHCPv6ã§å‰²ã‚Šå½“ã¦ã‚‹IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹
            "ip-addresses": ["xxxx:xxxx:2900:201::10"],
            // DHCPv6-PDã§é…å¸ƒã™ã‚‹IPv6 prefix
            // ã“ã®IPv6ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒWifié…ä¸‹ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹
            "prefixes": ["xxxx:xxxx:2900:210::/64"]
          }
        ]
      }
    ]
  },
  "Logging": {
    "loggers": [
      {
        "name": "kea-dhcp6",
        "output_options": [
          {
            "output": "/var/log/kea-dhcp6.log"
          }
        ],
        "severity": "DEBUG",
        // DEBUGã®å ´åˆã€debuglevelã®å€¤ãŒå¤§ãã„ã»ã©ãƒ­ã‚°ãŒè©³ç´°ã«ãªã‚‹
        "debuglevel": 20
      }
    ]
  }
}
```

## kea-dhcp4-server

ã“ã®è¨­å®šä¾‹ã§ã¯ã€DHCPv4ã®ã‚¢ãƒ‰ãƒ¬ã‚¹é…å¸ƒã‚‚Kea DHCPã‚µãƒ¼ãƒãƒ¼ã§è¡Œãªã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯å¿…é ˆã®æ§‹æˆã§ã¯ãªãã€ãƒ«ãƒ¼ã‚¿ãƒ¼ã§IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã®é…å¸ƒã‚’ã—ã¦ã‚‚å•é¡Œãªã„ã¨æ€ã„ã¾ã™ã€‚

### ã‚³ãƒãƒ³ãƒ‰ä¾‹

```
$ vi /etc/kea/kea-dhcp4.conf
$ sudo systemctl start kea-dhcp4-server.service
```

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¾‹

```json:/etc/kea/kea-dhcp4.conf
{
  "Dhcp4": {
    "interfaces-config": {
      // ä¾‹: eth0ã§DHCPã‚’èã
      "interfaces": ["eth0"]
    },
    "lease-database": {
      "type": "memfile",
      "lfc-interval": 3600
    },
    "option-data": [
      {
        // ä¾‹ï¼š CISCO Umbrellaã®DNSã‚µãƒ¼ãƒãƒ¼ã‚’æŒ‡å®š
        "name": "domain-name-servers",
        "data": "208.67.222.222, 208.67.220.220"
      },
      {
        // ä¾‹ï¼š Internet Multifeedã®NTPã‚’æŒ‡å®š
        "name": "ntp-servers",
        "data": "210.173.160.87, 210.173.160.57, 210.173.160.27"
      }
    ],
    "subnet4": [
      {
        "subnet": "192.168.90.0/24",
        // ã‚¢ãƒ‰ãƒ¬ã‚¹é…å¸ƒç¯„å›²
        "pools": [{ "pool": "192.168.90.100 - 192.168.90.249" }],
        "option-data": [
          {
            "name": "routers",
            "data": "192.168.90.1"
          }
        ]
      }
    ]
  },
  "Logging": {
    "loggers": [
      {
        "name": "kea-dhcp4",
        "output_options": [
          {
            "output": "/var/log/kea-dhcp4.log"
          }
        ],
        "severity": "INFO",
        "debuglevel": 0
      }
    ]
  }
}
```

# ãƒ•ãƒ¬ãƒƒãƒ„å…‰å´ã®ãƒ«ãƒ¼ã‚¿ãƒ¼ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®šã™ã‚‹

ã¾ãšã€Google Nest Wifiãƒ«ãƒ¼ã‚¿ãƒ¼ã®MACã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã€IPv6ã®ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨ˆç®—ã—ã¦ãŠãã¾ã™ã€‚ï¼ˆè¨ˆç®—ã™ã‚‹ã‚µã‚¤ãƒˆã¯ã‚°ã‚°ã‚Œã°å‡ºã¦ãã¾ã™ï¼‰

DHCPv6-PDã§é…å¸ƒã—ãŸprefixã®ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã«ã€è¨ˆç®—ã—ã¦ãŠã„ãŸGoogle Nest Wifiã®ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ã†å ´åˆã€ã‚¢ãƒ‰ãƒ¬ã‚¹ã®æœ€å¾Œã«I/Fã‚’æŒ‡å®šã™ã‚‹ `%lan1` ã‚’ã¤ã‘ã‚‹ã®ã‚’å¿˜ã‚Œãšã«ã€‚

```
ipv6 route xxxx:xxxx:2900:210::/64 gateway fe80::7ed9:aaff:fbbe:cc02%lan1
```

# Google Nest Wifiã®IPv6ã‚’æœ‰åŠ¹ã«ã™ã‚‹

ã‚ˆã†ã‚„ãGoogle Nest Wifiã§IPv6ã‚’æœ‰åŠ¹ã«ã™ã‚‹æº–å‚™ãŒã§ãã¾ã—ãŸã€‚IPv6ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã«ã¯ä»¥ä¸‹ã®é †ã§Google Homeã‚¢ãƒ—ãƒªã‚’æ“ä½œã—ã¾ã™ã€‚

Google Homeã‚¢ãƒ—ãƒªé–‹ã â†’ Wi-Fi â†’ è¨­å®šã‚¢ã‚¤ã‚³ãƒ³ â†’ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®è©³ç´°è¨­å®š â†’ IPv6ã‚’æœ‰åŠ¹

ã—ã°ã‚‰ãå¾…ã£ã¦keaã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã« `ALLOC_ENGINE_V6_HR_PREFIX_GRANTED` ãŒå‡ºã‚Œã°æˆåŠŸã§ã™ã€‚

```
2021-07-21 00:02:08.031 INFO  [kea-dhcp6.alloc-engine/4970] ALLOC_ENGINE_V6_HR_PREFIX_GRANTED reserved prefix xxxx:xxxx:2900:210::/64 was assigned to client duid=[xxxxx], tid=0xfffff
```

ãŠã¤ã‹ã‚Œã•ã¾ã§ã—ãŸã€‚
